<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saisie Physico-Chimique 2025</title>

<style>
:root { --primary:#1a73e8; --success:#1e8e3e; }
body { font-family: Arial, sans-serif; background:#f1f3f4; margin:0; padding:10px; }
.container { max-width:900px; margin:auto; background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,.1); }
.tabs { display:flex; border-bottom:1px solid #ddd; }
.tab-btn { flex:1; padding:14px; border:none; background:#f8f9fa; font-weight:bold; cursor:pointer; }
.tab-btn.active { background:#fff; color:var(--primary); border-bottom:3px solid var(--primary); }
form { padding:20px; }
.section { margin-bottom:20px; border:1px solid #ddd; border-radius:8px; padding:15px; }
.section-title { color:var(--primary); font-weight:bold; margin-bottom:10px; display:block; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(130px,1fr)); gap:10px; }
input { padding:8px; border:1px solid #ccc; border-radius:4px; }
.submit-btn { width:100%; padding:16px; background:var(--success); color:#fff; border:none; border-radius:8px; font-size:1.1rem; font-weight:bold; cursor:pointer; }
#status { display:none; margin-top:10px; padding:10px; text-align:center; border-radius:5px; font-weight:bold; }
</style>
</head>

<body>

<div class="container">

<div class="tabs">
  <button class="tab-btn active" onclick="setSheet('Brutes',this)">ğŸ’§ Eaux Brutes</button>
  <button class="tab-btn" onclick="setSheet('TraitÃ©es',this)">ğŸ§ª Eaux TraitÃ©es</button>
</div>

<form id="waterForm">
<input type="hidden" id="sheetInput" value="Brutes">

<!-- Identification -->
<div class="section">
<span class="section-title">Identification</span>
<div class="grid">
  <input name="NÂ°=" placeholder="NÂ°=" required>
  <input name="Point de prÃ©levement" placeholder="Point de prÃ©levement">
  <input name="Centre" placeholder="Centre">
  <input name="Communes" placeholder="Communes">
  <input type="date" name="Date">
</div>
</div>

<!-- Structure -->
<div class="section">
<span class="section-title">Structure de l'eau</span>
<div class="grid">
  <input name="Couleur" placeholder="Couleur">
  <input type="number" step="0.1" name="Temp." placeholder="Temp.">
  <input type="number" step="0.1" name="Cond." placeholder="Cond.">
  <input type="number" step="0.1" name="SalinirÃ©" placeholder="SalinirÃ©">
  <input type="number" step="0.1" name="TDS" placeholder="TDS">
  <input type="number" step="0.01" name="TurbiditÃ©" placeholder="TurbiditÃ©">
  <input type="number" step="0.1" name="pH" placeholder="pH">
  <input type="number" step="0.1" name="RS" placeholder="RS">
  <input type="number" step="0.1" name="MO" placeholder="MO">
</div>
</div>

<!-- Chimie -->
<div class="section">
<span class="section-title">Chimie & Micropolluants</span>
<div class="grid">
  <input type="number" step="0.1" name="Calcium" placeholder="Calcium">
  <input type="number" step="0.1" name="DuretÃ© T" placeholder="DuretÃ© T">
  <input type="number" step="0.1" name="MagnÃ©sium" placeholder="MagnÃ©sium">
  <input type="number" step="0.1" name="Sodium" placeholder="Sodium">
  <input type="number" step="0.1" name="Potassium" placeholder="Potassium">
  <input type="number" step="0.1" name="Ammonium" placeholder="Ammonium">
  <input type="number" step="0.1" name="Nitrites" placeholder="Nitrites">
  <input type="number" step="0.1" name="Nitrates" placeholder="Nitrates">
  <input type="number" step="0.1" name="Phosphates" placeholder="Phosphates">
  <input type="number" step="0.1" name="Chlorures" placeholder="Chlorures">
  <input type="number" step="0.1" name="AlcalinitÃ©" placeholder="AlcalinitÃ©">
  <input type="number" step="0.1" name="Bicarbonate" placeholder="Bicarbonate">
  <input type="number" step="0.1" name="Sulfates" placeholder="Sulfates">
  <input type="number" step="0.01" name="Fer total" placeholder="Fer total">
  <input type="number" step="0.01" name="ManganÃ¨se" placeholder="ManganÃ¨se">
  <input type="number" step="0.01" name="Aluminium" placeholder="Aluminium">
</div>
</div>

<button class="submit-btn">Enregistrer</button>
<div id="status"></div>
</form>

</div>

<script>
const API_URL = 'https://sheetdb.io/api/v1/8ghol9vmi3z4h';

function setSheet(name, btn){
  document.getElementById('sheetInput').value = name;
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

document.getElementById('waterForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const status = document.getElementById('status');
  status.style.display = 'block';
  status.innerText = 'Envoi...';
  status.style.background = '#e8f0fe';

  const sheet = document.getElementById('sheetInput').value;
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData.entries());

  // ğŸ”¥ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø­Ø§Ø³Ù…
  delete data.sheetInput;

  try {
    const url = `${API_URL}?sheet=${encodeURIComponent(sheet)}`;

    const res = await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ data: [data] })
    });

    if (!res.ok) {
      const text = await res.text();
      status.style.background = '#f8d7da';
      status.innerText = `âŒ Erreur (${res.status}) : ${text}`;
      return;
    }

    status.style.background = '#d4edda';
    status.innerText = 'âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­';
    e.target.reset();

  } catch (err) {
    status.style.background = '#f8d7da';
    status.innerText = 'âŒ Erreur rÃ©seau';
    console.error(err);
  }
});
</script>

</body>
</html>
